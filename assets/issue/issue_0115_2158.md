# Issue: 백엔드 API 연동 및 구조 변경
**작성일시:** 2026-01-15 21:58
**상태:** 진행 중 (코드 구현 완료, 서버 테스트 필요)

## 📝 개요
기존 LocalStorage 기반의 데이터 관리를 `https://art-app-back-server.onrender.com` REST API 기반으로 전환하는 작업입니다.

## 🛠️ 변경 사항 상세

### 1. 인증 시스템 (Authentication)
- **로그인/회원가입 뷰 구현**:
  - `src/components/views/LoginView.jsx`: 이메일(ID) 및 비밀번호 입력, 회원가입 전환 버튼.
  - `src/components/views/SignupView.jsx`: 이메일, 비밀번호, 닉네임 입력 및 유효성 검사.
- **전역 상태 관리**:
  - `App.jsx`에서 `user` 상태 관리 (`{ user_id, nickname }`).
  - `useLocalStorage`를 사용하여 로그인 세션 유지 (`imery-user`).
  - 로그인되지 않은 경우 메인 화면 대신 로그인/회원가입 화면을 렌더링하도록 Auth Guard 구현.

### 2. 데이터 통합 (Data Integration)
- **API 클라이언트**:
  - `src/api/client.js`: `fetch` API를 래핑하여 구현.
  - `login`, `signup`, `getPosts`, `createPost` 메서드 제공.
- **피드 조회**:
  - 앱 시작 시 `getPosts`를 호출하여 서버 데이터를 가져옴.
  - 서버 데이터 포맷을 앱 내부 포맷으로 매핑하는 로직을 `App.jsx`의 `useEffect`에 구현.
  - 매핑: `artist_name` → `artist`, `image_url` → `thumbnail`, `created_at` → `date`.
  - **제약 사항**: 현재 API는 태그(tags)를 지원하지 않아 빈 배열로 초기화됨.

### 3. 작품 업로드 및 수정 (Review Form)
- **필드 추가 및 재배치**:
  - **작가 이름(Artist Name)** 필드 추가 (필수 입력).
  - 필드 순서 변경: 작가 이름 → 작품 이름 → 카테고리 → 평점 → 감상평.
- **기능 개선**:
  - **'작가 미상' 버튼**: 클릭 시 작가 이름 필드에 "작가 미상" 자동 입력 및 토글 UI 적용.
  - **유효성 검사**: 작가 이름과 작품 이름이 없으면 저장 불가 (Alert 표시).
- **데이터 처리**:
  - 신규 생성 시: `api.createPost` 호출.
  - 수정 시: API가 수정(PUT)을 지원하지 않아 **로컬 상태만 업데이트**하도록 구현됨 (Alert로 사용자에게 고지).

### 4. UI/UX 개선
- **피드 레이아웃**:
  - `src/components/WorksList.jsx`에서 `Large` 레이아웃을 인스타그램 피드 스타일로 개선.
    - 상단: 작성자 닉네임 표시.
    - 하단: 작품 정보, 감상평, 오디오 플레이어 노출.
- **상세 페이지 (Detail View)**:
  - `src/components/views/WorkDetailView.jsx`에 AI 요약(`ai_summary`) 및 오디오 플레이어(`music_url`) 섹션 추가.
  - **마이 페이지 (My Page)**:
    - `src/components/views/MyView.jsx` 신규 구현.
    - 로그인 사용자 정보(닉네임, 이메일) 및 통계(작품 수, 평균 평점) 표시.
    - 로그아웃 기능 구현 (클릭 시 로그인 화면으로 이동 및 세션 해제).

### 5. 데이터베이스 (Database)
- **스키마 정의**:
  - `database.sql`: `Users` 및 `Posts` 테이블 생성 쿼리 작성 완료 (프로젝트 루트 위치).
  - 인덱스 및 외래키 제약조건 포함.

## ⚠️ 알려진 문제 및 주의사항 (Known Issues)

1. **이미지 업로드 용량 제한**:
   - 현재 프론트엔드는 이미지를 **Base64** 문자열로 변환하여 `image_url` 필드에 담아 전송합니다.
   - 백엔드 서버 설정에 따라 요청 본문(Body) 크기 제한으로 인해 대용량 이미지 업로드 시 413 에러가 발생할 수 있습니다.
   - **해결 방안**: 향후 이미지 호스팅 서버(S3, Imgur API 등)를 연동하여 URL만 전송하는 방식으로 변경 필요.

2. **데이터 마이그레이션**:
   - 기존 사용자가 LocalStorage에 저장한 데이터(`imery-works`)는 서버로 자동 이관되지 않습니다. 현재는 API 데이터로 덮어씌워짐.

3. **수정/삭제 기능 제한**:
   - 제공된 API 명세에 게시글 **수정(PUT)** 및 **삭제(DELETE)** 엔드포인트가 없습니다.
   - 현재 구현은 로컬 상태만 변경하며, 새로고침 시 초기화됩니다. 백엔드 지원이 필요합니다.

4. **오디오/AI 요약 데이터**:
   - 업로드 시 `music_url`과 `ai_summary`를 생성하는 로직은 백엔드에 의존합니다. (현재 프론트엔드에서는 빈 값 또는 더미 데이터를 보낼 수도 있음)

## 📋 다음 작업자를 위한 가이드

1. **테스트 환경**:
   - `npm run dev`로 개발 서버를 실행하세요.
   - 백엔드 서버(`https://art-app-back-server.onrender.com`)가 살아있는지 확인하세요.

2. **우선순위 작업**:
   - 서버의 이미지 용량 제한 확인 및 테스트.
   - 게시글 수정/삭제 API가 추가되면 `src/api/client.js` 및 `App.jsx`의 핸들러 연동.
   - 태그(Tag) 기능이 필요하다면 백엔드 요청 또는 `description`에 해시태그 형식으로 포함하는 룰 정립 필요.
